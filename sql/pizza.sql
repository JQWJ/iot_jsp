CREATE TABLE TBL_PIZZA_01 (
    PCODE CHAR(4) NOT NULL,
    PNAME VARCHAR2(30),
    COST NUMBER(7),
    CONSTRAINT PK_PIZZA PRIMARY KEY (PCODE)
);

CREATE TABLE TBL_SHOP_01 (
    SCODE CHAR(4) NOT NULL,
    SNAME VARCHAR2(20),
    CONSTRAINT PK_SHOP PRIMARY KEY (SCODE)
);

CREATE TABLE TBL_SALELIST_01 (
    SALENO NUMBER(7) NOT NULL,
    SCODE CHAR(4) NOT NULL,
    SALEDATE DATE,
    PCODE CHAR(4) NOT NULL,
    AMOUNT NUMBER(5),
    CONSTRAINT PK_SALELIST PRIMARY KEY (SALENO)
);

INSERT INTO TBL_PIZZA_01 VALUES ('AA01',    '고르골졸라피자',	6000);
INSERT INTO TBL_PIZZA_01 VALUES ('AA02',    '치즈피자',	6500);
INSERT INTO TBL_PIZZA_01 VALUES ('AA03',    '페퍼로니피자',	7000);
INSERT INTO TBL_PIZZA_01 VALUES ('AA04',    '콤비네이션피자',	7500);
INSERT INTO TBL_PIZZA_01 VALUES ('AA05',    '고구마피자',	6000);
INSERT INTO TBL_PIZZA_01 VALUES ('AA06',    '토네이도피자',	7000);
INSERT INTO TBL_PIZZA_01 VALUES ('AA07',    '불고기피자',	8000);
INSERT INTO TBL_PIZZA_01 VALUES ('AA08',    '나폴리피자',	8000);

INSERT INTO TBL_SHOP_01 VALUES ('S001',	'강남점');
INSERT INTO TBL_SHOP_01 VALUES ('S002',	'강서점');
INSERT INTO TBL_SHOP_01 VALUES ('S003',	'강동점');
INSERT INTO TBL_SHOP_01 VALUES ('S004',	'영동점');
INSERT INTO TBL_SHOP_01 VALUES ('S005',	'시청점');
INSERT INTO TBL_SHOP_01 VALUES ('S006',	'인천점');

INSERT INTO TBL_SALELIST_01 VALUES (100001,	'S001',	'2018-12-02',	'AA01',	50);
INSERT INTO TBL_SALELIST_01 VALUES (100002,	'S001',	'2018-12-02',	'AA02',	30);
INSERT INTO TBL_SALELIST_01 VALUES (100003,	'S001',	'2018-12-02',	'AA03',	20);
INSERT INTO TBL_SALELIST_01 VALUES (100004,	'S001',	'2018-12-02',	'AA04',	50);
INSERT INTO TBL_SALELIST_01 VALUES (100005,	'S003',	'2018-12-03',	'AA01',	40);
INSERT INTO TBL_SALELIST_01 VALUES (100006,	'S003',	'2018-12-03',	'AA02',	60);
INSERT INTO TBL_SALELIST_01 VALUES (100007,	'S003',	'2018-12-03',	'AA04',	60);
INSERT INTO TBL_SALELIST_01 VALUES (100008,	'S003',	'2018-12-04',	'AA05',	70);
INSERT INTO TBL_SALELIST_01 VALUES (100009,	'S005',	'2018-12-02',	'AA01',	80);
INSERT INTO TBL_SALELIST_01 VALUES (100010,	'S005',	'2018-12-02',	'AA03',	30);
INSERT INTO TBL_SALELIST_01 VALUES (100011,	'S005',	'2018-12-02',	'AA04',	40);
INSERT INTO TBL_SALELIST_01 VALUES (100012,	'S005',	'2018-12-02',	'AA05',	50);
INSERT INTO TBL_SALELIST_01 VALUES (100013,	'S004',	'2018-12-04',	'AA01',	30);
INSERT INTO TBL_SALELIST_01 VALUES (100014,	'S004',	'2018-12-04',	'AA02',	20);
INSERT INTO TBL_SALELIST_01 VALUES (100015,	'S004',	'2018-12-04',	'AA06',	50);

SELECT 
    SALELIST.SALENO, SHOP.SCODE || '-' || SHOP.SNAME, SALELIST.SALEDATE, 
    PIZZA.PCODE, SALELIST.AMOUNT, PIZZA.COST * SALELIST.AMOUNT AS TOTAL_COST
FROM 
    TBL_SALELIST_01 SALELIST, TBL_SHOP_01 SHOP, TBL_PIZZA_01 PIZZA
WHERE
    SALELIST.SCODE = SHOP.SCODE AND
    SALELIST.PCODE = PIZZA.PCODE;
    
SELECT
    SHOP.SCODE,SHOP.SNAME,
    SUM(PIZZA.COST * SALELIST.AMOUNT) AS TOTAL_COST
FROM
    TBL_SALELIST_01 SALELIST,
    TBL_SHOP_01 SHOP,
    TBL_PIZZA_01 PIZZA
WHERE
    SALELIST.SCODE = SHOP.SCODE
    AND SALELIST.PCODE = PIZZA.PCODE
GROUP BY
    SHOP.SCODE, SHOP.SNAME
ORDER BY TOTAL_COST DESC;

SELECT
    PIZZA.PNAME,
    SUM(PIZZA.COST * SALELIST.AMOUNT) AS TOTAL_COST
FROM
    TBL_PIZZA_01 PIZZA, TBL_SALELIST_01 SALELIST, TBL_SHOP_01 SHOP
WHERE
    SALELIST.SCODE = SHOP.SCODE
    AND SALELIST.PCODE = PIZZA.PCODE
GROUP BY
    PIZZA.PNAME, PIZZA.PCODE
ORDER BY
    TOTAL_COST DESC;

INSERT INTO TBL_PIZZA_01(PCODE, PNAME, COST) VALUES('토네이도피자', 'PCODE001', 120000);

CREATE TABLE product (
    product_id number(10) NOT NULL,
    name varchar2(40),
    price number(10),
    category_id number(10) NOT NULL
);

CREATE TABLE category (
    category_id number(10) NOT NULL,
    name varchar2(20)
);

CREATE TABLE sale (
    sale_id number(10) NOT NULL,
    product_id number(10) NOT NULL,
    purchase_date date,
    sale_price number(10) NOT NULL,
    amount number(5) NOT NULL
);

create sequence seq_sale 
increment by 1
start with 1;

INSERT INTO PRODUCT VALUES (1, '컴퓨터', 1000000, 1);
INSERT INTO PRODUCT VALUES (2, '태블릿 PC', 800000, 1);
INSERT INTO PRODUCT VALUES (3, '핸드폰', 1200000, 1);
INSERT INTO PRODUCT VALUES (4, '헤드셋', 80000, 1);
INSERT INTO PRODUCT VALUES (5, '무선 이어폰', 210000, 1);
INSERT INTO PRODUCT VALUES (6, '책상', 160000, 1);
INSERT INTO PRODUCT VALUES (7, '의자', 90000, 1);
INSERT INTO PRODUCT VALUES (8, '소고기', 12000, 1);
INSERT INTO PRODUCT VALUES (9, '티셔츠', 58000, 1);

INSERT INTO CATEGORY VALUES (1, '전자제품');
INSERT INTO CATEGORY VALUES (2, '가구');
INSERT INTO CATEGORY VALUES (3, '식품');
INSERT INTO CATEGORY VALUES (4, '의류');

INSERT INTO SALE VALUES (1, 1, '2020-01-01', 1000000, 1);
INSERT INTO SALE VALUES (2, 2, '2020-01-01', 1600000, 2);
INSERT INTO SALE VALUES (3, 1, '2020-01-01', 2000000, 2);
INSERT INTO SALE VALUES (4, 4, '2020-01-02', 240000, 3);
INSERT INTO SALE VALUES (5, 5, '2020-01-04', 210000, 1);
INSERT INTO SALE VALUES (6, 6, '2020-01-06', 320000, 2);
INSERT INTO SALE VALUES (7, 7, '2020-01-11', 360000, 4);
INSERT INTO SALE VALUES (8, 8, '2020-01-15', 60000, 5);
INSERT INTO SALE VALUES (9, 9, '2020-01-17', 58000, 1);
INSERT INTO SALE VALUES (10, 9, '2020-01-20', 580000, 10);
INSERT INTO SALE VALUES (11, 2, '2020-01-21', 1600000, 2);
INSERT INTO SALE VALUES (12, 1, '2020-01-22', 1000000, 1);
INSERT INTO SALE VALUES (13, 4, '2020-01-24', 80000, 1);
INSERT INTO SALE VALUES (14, 5, '2020-01-26', 210000, 1);
INSERT INTO SALE VALUES (15, 6, '2020-01-29', 160000, 1);